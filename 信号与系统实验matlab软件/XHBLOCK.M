function [ret,x0,str,ts,xts]=xhblock(t,x,u,flag);
%XHBLOCK	is the M-file description of the SIMULINK system named XHBLOCK.
%	The block-diagram can be displayed by typing: XHBLOCK.
%
%	SYS=XHBLOCK(T,X,U,FLAG) returns depending on FLAG certain
%	system values given time point, T, current state vector, X,
%	and input vector, U.
%	FLAG is used to indicate the type of output to be returned in SYS.
%
%	Setting FLAG=1 causes XHBLOCK to return state derivatives, FLAG=2
%	discrete states, FLAG=3 system outputs and FLAG=4 next sample
%	time. For more information and other options see SFUNC.
%
%	Calling XHBLOCK with a FLAG of zero:
%	[SIZES]=XHBLOCK([],[],[],0),  returns a vector, SIZES, which
%	contains the sizes of the state vector and other parameters.
%		SIZES(1) number of states
%		SIZES(2) number of discrete states
%		SIZES(3) number of outputs
%		SIZES(4) number of inputs
%		SIZES(5) number of roots (currently unsupported)
%		SIZES(6) direct feedthrough flag
%		SIZES(7) number of sample times
%
%	For the definition of other parameters in SIZES, see SFUNC.
%	See also, TRIM, LINMOD, LINSIM, EULER, RK23, RK45, ADAMS, GEAR.

% Note: This M-file is only used for saving graphical information;
%       after the model is loaded into memory an internal model
%       representation is used.

% the system will take on the name of this mfile:
sys = mfilename;
new_system(sys)
simver(1.3)
if (0 == (nargin + nargout))
     set_param(sys,'Location',[143,165,481,345])
     open_system(sys)
end;
set_param(sys,'algorithm',     'RK-45')
set_param(sys,'Start time',    '0.0')
set_param(sys,'Stop time',     '999999')
set_param(sys,'Min step size', '0.0001')
set_param(sys,'Max step size', '10')
set_param(sys,'Relative error','1e-3')
set_param(sys,'Return vars',   '')

add_block('built-in/Scope',[sys,'/','示波器'])
set_param([sys,'/','示波器'],...
		'Font Name','宋体',...
		'Font Size',12,...
		'Vgain','1.000000',...
		'Hgain','1.000000',...
		'Vmax','2.000000',...
		'Hmax','2.000000',...
		'Window',[100,100,380,320],...
		'position',[55,122,75,148])

add_block('built-in/Note',[sys,'/','最常用的模块：'])
set_param([sys,'/','最常用的模块：'],...
		'Font Name','宋体',...
		'Font Size',12,...
		'position',[76,26,81,31])

add_block('built-in/Gain',[sys,'/','增益'])
set_param([sys,'/','增益'],...
		'Font Name','宋体',...
		'Font Size',12,...
		'position',[125,62,150,88])

add_block('built-in/Step Fcn',[sys,'/','阶跃输入'])
set_param([sys,'/','阶跃输入'],...
		'Font Name','宋体',...
		'Font Size',12,...
		'position',[185,61,215,89])

add_block('built-in/Signal Generator',[sys,'/','信号发生器'])
set_param([sys,'/','信号发生器'],...
		'Font Name','宋体',...
		'Font Size',12,...
		'Peak','1.000000',...
		'Peak Range','5.000000',...
		'Freq','1.000000',...
		'Freq Range','5.000000',...
		'Wave','Sin',...
		'Units','Rads')
set_param([sys,'/','信号发生器'],...
		'position',[50,66,90,94])

add_block('built-in/Sine Wave',[sys,'/','正弦波'])
set_param([sys,'/','正弦波'],...
		'Font Name','宋体',...
		'Font Size',12,...
		'position',[250,62,280,88])

add_block('built-in/Product',[sys,'/','乘法器'])
set_param([sys,'/','乘法器'],...
		'Font Name','宋体',...
		'Font Size',12,...
		'position',[195,122,220,153])

add_block('built-in/Sum',[sys,'/','加法器'])
set_param([sys,'/','加法器'],...
		'Font Name','宋体',...
		'Font Size',12,...
		'position',[120,124,145,151])


%     Subsystem  '脉冲发生器'.

new_system([sys,'/','脉冲发生器'])
set_param([sys,'/','脉冲发生器'],'Location',[158,441,759,682])

add_block('built-in/Outport',[sys,'/','脉冲发生器/out_1'])
set_param([sys,'/','脉冲发生器/out_1'],...
		'hide name',0,...
		'position',[560,105,580,125])

add_block('built-in/Gain',[sys,'/','脉冲发生器/Gain'])
set_param([sys,'/','脉冲发生器/Gain'],...
		'hide name',0,...
		'Gain','ht',...
		'position',[510,102,535,128])

add_block('built-in/Product',[sys,'/','脉冲发生器/Product'])
set_param([sys,'/','脉冲发生器/Product'],...
		'hide name',0,...
		'position',[455,105,480,125])

add_block('built-in/Logical Operator',[sys,'/',['脉冲发生器/Logical',13,'Operator1']])
set_param([sys,'/',['脉冲发生器/Logical',13,'Operator1']],...
		'Operator','NOT',...
		'Number of Input Ports','1',...
		'position',[355,38,385,62])

add_block('built-in/Logical Operator',[sys,'/',['脉冲发生器/Logical',13,'Operator']])
set_param([sys,'/',['脉冲发生器/Logical',13,'Operator']],...
		'Operator','XOR',...
		'position',[285,38,315,62])

add_block('built-in/Constant',[sys,'/','脉冲发生器/Constant1'])
set_param([sys,'/','脉冲发生器/Constant1'],...
		'Value','stt',...
		'position',[295,149,320,171])

add_block('built-in/Clock',[sys,'/','脉冲发生器/Clock1'])
set_param([sys,'/','脉冲发生器/Clock1'],...
		'hide name',0,...
		'position',[295,100,315,120])

add_block('built-in/Relational Operator',[sys,'/',['脉冲发生器/Relational',13,'operator']])
set_param([sys,'/',['脉冲发生器/Relational',13,'operator']],...
		'hide name',0,...
		'position',[370,102,400,133])

add_block('built-in/Sum',[sys,'/','脉冲发生器/Sum1'])
set_param([sys,'/','脉冲发生器/Sum1'],...
		'hide name',0,...
		'inputs','+-',...
		'position',[130,120,150,140])

add_block('built-in/Sum',[sys,'/','脉冲发生器/Sum'])
set_param([sys,'/','脉冲发生器/Sum'],...
		'hide name',0,...
		'inputs','+-',...
		'position',[135,35,155,55])

add_block('built-in/Constant',[sys,'/','脉冲发生器/Constant'])
set_param([sys,'/','脉冲发生器/Constant'],...
		'position',[25,30,45,50])

add_block('built-in/Unit Delay',[sys,'/','脉冲发生器/Unit Delay'])
set_param([sys,'/','脉冲发生器/Unit Delay'],...
		'orientation',2,...
		'Sample time','[Ts,st1]',...
		'position',[145,75,195,95])

add_block('built-in/Unit Delay',[sys,'/','脉冲发生器/Unit Delay1'])
set_param([sys,'/','脉冲发生器/Unit Delay1'],...
		'orientation',2,...
		'Sample time','[Ts,st2]',...
		'x0','ini',...
		'position',[140,165,190,185])
add_line([sys,'/','脉冲发生器'],[390,50;430,50;430,110;450,110])
add_line([sys,'/','脉冲发生器'],[320,50;350,50])
add_line([sys,'/','脉冲发生器'],[325,160;345,160;345,125;365,125])
add_line([sys,'/','脉冲发生器'],[540,115;555,115])
add_line([sys,'/','脉冲发生器'],[485,115;505,115])
add_line([sys,'/','脉冲发生器'],[405,120;450,120])
add_line([sys,'/','脉冲发生器'],[320,110;365,110])
add_line([sys,'/','脉冲发生器'],[140,85;105,85;105,50;130,50])
add_line([sys,'/','脉冲发生器'],[160,45;230,45;230,85;200,85])
add_line([sys,'/','脉冲发生器'],[50,40;130,40])
add_line([sys,'/','脉冲发生器'],[155,130;210,130;210,175;195,175])
add_line([sys,'/','脉冲发生器'],[135,175;100,175;100,135;125,135])
add_line([sys,'/','脉冲发生器'],[50,40;70,40;70,125;125,125])
add_line([sys,'/','脉冲发生器'],[160,45;280,45])
add_line([sys,'/','脉冲发生器'],[155,130;245,130;245,55;280,55])
set_param([sys,'/','脉冲发生器'],...
		'Mask Display','plot(0,0,100,100,[90,75,75,60,60,35,35,20,20,10],[20,20,80,80,20,20,80,80,20,20])',...
		'Mask Type','Pulse Generator')
set_param([sys,'/','脉冲发生器'],...
		'Mask Dialogue','Pulse Generator.|Pulse period (secs):|Pulse width:|Pulse height:|Pulse start time:')
set_param([sys,'/','脉冲发生器'],...
		'Mask Translate','Ts=@1; du=@2; ht=@3; stt=@4; ini=ones(length(ht),1); st1=rem(stt,Ts); st2=rem(stt+du,Ts);if(Ts<=1.2*du),ini=zeros(length(ht),1);end;')
set_param([sys,'/','脉冲发生器'],...
		'Mask Help','Pulse generator which ensures pulse\ntransitions are hit. Provides a vector of pulses when the height is entered as a vector.\nUnmask to see how it works.',...
		'Mask Entries','3\/1\/1\/0.5\/')


%     Finished composite block '脉冲发生器'.

set_param([sys,'/','脉冲发生器'],...
		'Font Name','宋体',...
		'Font Size',12,...
		'position',[255,117,290,153])

drawnow

% Return any arguments.
if (nargin | nargout)
	% Must use feval here to access system in memory
	if (nargin > 3)
		if (flag == 0)
			eval(['[ret,x0,str,ts,xts]=',sys,'(t,x,u,flag);'])
		else
			eval(['ret =', sys,'(t,x,u,flag);'])
		end
	else
		[ret,x0,str,ts,xts] = feval(sys);
	end
else
	drawnow % Flash up the model and execute load callback
end
